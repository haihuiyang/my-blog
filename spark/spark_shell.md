import betapha.data.register.RunnerContainer
import org.apache.spark.sql._
import org.apache.spark.{SparkConf, SparkContext}

val conf = new SparkConf().setAppName("GTA_TO_BETALPHA").set("spark.cassandra.connection.host", "localhost").setMaster("local")

val sc = new SparkContext(conf)

val spark = SparkSession.builder().appName("Spark SQL basic example").getOrCreate()



+------------+----------+------+--------------------+-----------+
|benchmark_id|stock_code|weight|        trading_date|close_price|
+------------+----------+------+--------------------+-----------+
|      000905|    002366| 0.249|2016-07-01 08:00:...|     60.869|
|      000905|    002366| 0.249|2016-07-04 08:00:...|     61.132|
|      000905|    002366| 0.249|2016-07-05 08:00:...|     62.938|
|      000905|    002366| 0.249|2016-07-06 08:00:...|     63.612|
|      000905|    002366| 0.249|2016-07-07 08:00:...|     62.755|
|      000905|    002366| 0.249|2016-07-08 08:00:...|     62.618|
|      000905|    002366| 0.249|2016-07-11 08:00:...|     61.269|
|      000905|    002366| 0.249|2016-07-12 08:00:...|       60.4|
|      000905|    002366| 0.249|2016-07-13 08:00:...|     61.441|
|      000905|    002366| 0.249|2016-07-14 08:00:...|     60.618|
|      000905|    002366| 0.249|2016-07-15 08:00:...|     61.898|
|      000905|    002366| 0.249|2016-07-18 08:00:...|     63.395|
|      000905|    002366| 0.249|2016-07-19 08:00:...|     61.818|
|      000905|    002366| 0.249|2016-07-20 08:00:...|     60.536|
|      000905|    002366| 0.249|2016-07-21 08:00:...|     60.021|
|      000905|    002366| 0.249|2016-07-22 08:00:...|     58.751|
|      000905|    002366| 0.249|2016-07-25 08:00:...|      60.25|
|      000905|    002366| 0.249|2016-07-26 08:00:...|      61.44|
|      000905|    002366| 0.249|2016-07-27 08:00:...|     58.557|
|      000905|    002366| 0.249|2016-07-28 08:00:...|      58.58|
+------------+----------+------+--------------------+-----------+




+------------+----------+------+--------------------+-----------+--------------+
|benchmark_id|stock_code|weight|        trading_date|close_price|rate_of_return|
+------------+----------+------+--------------------+-----------+--------------+
|      000905|    002366| 0.249|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.245|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.251|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.252|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.248|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.248|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.243|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.236|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.238|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.235|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366|  0.24|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.247|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366|  0.24|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.236|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.233|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366|  0.23|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.235|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.236|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.235|2016-07-01 08:00:...|     60.869|           0.0|
|      000905|    002366| 0.234|2016-07-01 08:00:...|     60.869|           0.0|
+------------+----------+------+--------------------+-----------+--------------+



+------------+----------+------+--------------------+-----------+---------------+
|benchmark_id|stock_code|weight|        trading_date|close_price|pre_close_price|
+------------+----------+------+--------------------+-----------+---------------+
|      000905|    002366| 0.249|2016-07-01 08:00:...|     60.869|         60.869|
|      000905|    002366| 0.249|2016-07-04 08:00:...|     61.132|         60.869|
|      000905|    002366| 0.249|2016-07-05 08:00:...|     62.938|         61.132|
|      000905|    002366| 0.249|2016-07-06 08:00:...|     63.612|         62.938|
|      000905|    002366| 0.249|2016-07-07 08:00:...|     62.755|         63.612|
|      000905|    002366| 0.249|2016-07-08 08:00:...|     62.618|         62.755|
|      000905|    002366| 0.249|2016-07-11 08:00:...|     61.269|         62.618|
|      000905|    002366| 0.249|2016-07-12 08:00:...|       60.4|         61.269|
|      000905|    002366| 0.249|2016-07-13 08:00:...|     61.441|           60.4|
|      000905|    002366| 0.249|2016-07-14 08:00:...|     60.618|         61.441|
|      000905|    002366| 0.249|2016-07-15 08:00:...|     61.898|         60.618|
|      000905|    002366| 0.249|2016-07-18 08:00:...|     63.395|         61.898|
|      000905|    002366| 0.249|2016-07-19 08:00:...|     61.818|         63.395|
|      000905|    002366| 0.249|2016-07-20 08:00:...|     60.536|         61.818|
|      000905|    002366| 0.249|2016-07-21 08:00:...|     60.021|         60.536|
|      000905|    002366| 0.249|2016-07-22 08:00:...|     58.751|         60.021|
|      000905|    002366| 0.249|2016-07-25 08:00:...|      60.25|         58.751|
|      000905|    002366| 0.249|2016-07-26 08:00:...|      61.44|          60.25|
|      000905|    002366| 0.249|2016-07-27 08:00:...|     58.557|          61.44|
|      000905|    002366| 0.249|2016-07-28 08:00:...|      58.58|         58.557|
+------------+----------+------+--------------------+-----------+---------------+



without order by ,count is : 3564000



3564000